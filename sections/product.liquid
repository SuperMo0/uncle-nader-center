{{ 'product.css' | asset_url | stylesheet_tag }}
<script src="{{ 'product.js' | asset_url }}" defer="defer"></script>

<div class="product-section">
  <div class="product-grid">
    <!-- Gallery -->
    <div class="product-gallery">
      <div class="product-gallery__main">
        {%- assign featured_media = product.selected_or_first_available_variant.featured_media
          | default: product.featured_media
        -%}

        {% if featured_media %}
          <img
            id="ProductImage-{{ section.id }}"
            src="{{ featured_media | image_url: width: 800 }}"
            alt="{{ featured_media.alt | escape }}"
            loading="eager"
            width="800"
            height="{{ 800 | divided_by: featured_media.aspect_ratio | ceil }}"
          >
        {% else %}
          {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
        {% endif %}
      </div>
    </div>

    <!-- Product Info -->
    <div class="product-info">
      <h1 class="product-title">{{ product.title }}</h1>

      <div class="product-price" id="Price-{{ section.id }}">
        {{ product.selected_or_first_available_variant.price | money }}
        {% if product.selected_or_first_available_variant.compare_at_price
            > product.selected_or_first_available_variant.price
        %}
          <s style="color:var(--ammo-gray); font-size: 0.8em;">
            {{- product.selected_or_first_available_variant.compare_at_price | money -}}
          </s>
        {% endif %}
      </div>

      <div class="product-description">
        {{ product.description }}
      </div>

      <!-- Product Form -->
      {% form 'product', product, class: 'product-form', id: 'product-form-installment' %}
        <input
          type="hidden"
          name="id"
          value="{{ product.selected_or_first_available_variant.id }}"
          id="MasterId-{{ section.id }}"
        >

        {%- unless product.has_only_default_variant -%}
          <div class="product-variants" data-section="{{ section.id }}" data-url="{{ product.url }}">
            {%- for option in product.options_with_values -%}
              <fieldset class="product-form__input">
                <legend class="product-form__label">{{ option.name }}</legend>
                <div class="product-form__options">
                  {%- for value in option.values -%}
                    <input
                      type="radio"
                      id="{{ section.id }}-{{ option.position }}-{{ forloop.index0 }}"
                      name="{{ option.name }}"
                      value="{{ value | escape }}"
                      class="product-form__radio js-variant-radio"
                      form="{{ 'product-form-installment' }}"
                      {% if option.selected_value == value %}
                        checked
                      {% endif %}
                    >
                    <label
                      for="{{ section.id }}-{{ option.position }}-{{ forloop.index0 }}"
                      class="product-form__swatch"
                    >
                      {{ value }}
                    </label>
                  {%- endfor -%}
                </div>
              </fieldset>
            {%- endfor -%}
          </div>
        {%- endunless -%}

        <div class="product-form__actions">
          <div class="input-stepper">
            <button type="button" class="input-stepper__button" onclick="updateProductQty(-1)">
              <span>&minus;</span>
            </button>
            <input
              type="number"
              name="quantity"
              value="1"
              min="1"
              id="Quantity-{{ section.id }}"
              class="input-stepper__input"
              aria-label="الكمية"
            >
            <button type="button" class="input-stepper__button" onclick="updateProductQty(1)">
              <span>&plus;</span>
            </button>
          </div>

          <button
            type="submit"
            name="add"
            id="Submit-{{ section.id }}"
            class="product-form__submit"
            {% if product.selected_or_first_available_variant.available == false %}
              disabled
            {% endif %}
          >
            {% if product.selected_or_first_available_variant.available %}
              أضف إلى السلة
            {% else %}
              نفذت الكمية
            {% endif %}
          </button>
        </div>
      {% endform %}
    </div>
  </div>
</div>

<script type="application/json" id="ProductJSON-{{ section.id }}">
  {{ product.variants | json }}
</script>

{% schema %}
{
  "name": "Product Page",
  "settings": [],
  "presets": [
    {
      "name": "Product Page"
    }
  ]
}
{% endschema %}
